<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doraemon Mini App</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="//libtl.com/sdk.js" data-zone="9842278" data-sdk="show_9842278"></script>
  <style>
    body.dark { background: #0f172a; color: #e2e8f0; }
    body.light { background: #f8fafc; color: #1e293b; }
    .card { border-radius: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
  </style>
</head>
<body class="light transition duration-300">

  <!-- Header -->
  <header class="p-4 flex justify-between items-center card bg-gradient-to-r from-blue-500 to-cyan-400 text-white">
    <div class="flex items-center gap-3">
      <img src="https://upload.wikimedia.org/wikipedia/en/b/bd/Doraemon_character.png" class="w-12 h-12 rounded-full border">
      <h1 class="text-xl font-bold">Doraemon Earn App</h1>
    </div>
    <button id="toggleTheme" class="px-3 py-1 rounded bg-white text-black">ЁЯМЩ</button>
  </header>

  <!-- Main -->
  <main class="p-4 space-y-4 max-w-lg mx-auto">
    
    <!-- Profile -->
    <section class="card p-4 bg-white dark:bg-slate-800">
      <h2 class="text-lg font-semibold mb-2">ЁЯСд ржкрзНрж░рзЛржлрж╛ржЗрж▓</h2>
      <p id="username">Name: рж▓рзЛржб рж╣ржЪрзНржЫрзЗ...</p>
      <p id="balance">ржмрзНржпрж╛рж▓рж╛ржирзНрж╕: 0.00 ржЯрж╛ржХрж╛</p>
      <p id="adsCount">ржЖржЬржХрзЗрж░ ржмрж┐ржЬрзНржЮрж╛ржкржи: 0/100</p>
      <p id="refCode">рж░рзЗржлрж╛рж░ ржХрзЛржб: ...</p>
    </section>

    <!-- Ads -->
    <section class="card p-4 bg-white dark:bg-slate-800 text-center">
      <h2 class="text-lg font-semibold mb-2">ЁЯУ║ ржмрж┐ржЬрзНржЮрж╛ржкржи ржжрзЗржЦрзБржи</h2>
      <div id="ad-container" class="my-3">
        <!-- Monetag ads will appear -->
      </div>
      <button id="watchAd" class="bg-blue-600 text-white px-4 py-2 rounded">тЦ╢я╕П Watch Ad</button>
      <p class="mt-2 text-sm text-gray-500">ржкрзНрж░рждрж┐ ржмрж┐ржЬрзНржЮрж╛ржкржирзЗ: 0.20 ржЯрж╛ржХрж╛ (рззрзж рж╕рзЗржХрзЗржирзНржб ржкрж░ ржпрзЛржЧ рж╣ржмрзЗ)</p>
    </section>

    <!-- Withdraw -->
    <section class="card p-4 bg-white dark:bg-slate-800">
      <h2 class="text-lg font-semibold mb-2">ЁЯТ╕ ржЙржЗржержбрзНрж░</h2>
      <input id="withdrawNumber" type="text" placeholder="ржмрж┐ржХрж╛рж╢ ржирж╛ржорзНржмрж╛рж░" class="w-full p-2 border rounded mb-2 dark:bg-slate-700">
      <input id="withdrawAmount" type="number" placeholder="ржкрж░рж┐ржорж╛ржг (ржорж┐ржи рззрзж)" class="w-full p-2 border rounded mb-2 dark:bg-slate-700">
      <button id="withdrawBtn" class="bg-green-600 text-white px-4 py-2 rounded w-full">рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ ржкрж╛ржарж╛ржи</button>
      <button onclick="copyNumber()" class="mt-2 text-sm underline text-blue-500">ЁЯУЛ ржирж╛ржорзНржмрж╛рж░ ржХржкрж┐ ржХрж░рзБржи</button>
    </section>

    <!-- Referral -->
    <section class="card p-4 bg-white dark:bg-slate-800">
      <h2 class="text-lg font-semibold mb-2">ЁЯСе рж░рзЗржлрж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржо</h2>
      <p>ржкрзНрж░рждрж┐ рж░рзЗржлрж╛рж░рзЗ: 0.30 ржЯрж╛ржХрж╛</p>
      <p>ржЖржкржирж╛рж░ рж▓рж┐ржВржХ:</p>
      <input id="refLink" class="w-full p-2 border rounded dark:bg-slate-700" readonly>
    </section>

    <!-- Footer -->
    <footer class="text-center text-sm text-gray-500 mt-6">
      тП░ <span id="clock"></span> | <a href="https://t.me/yourchannel" target="_blank" class="underline">ЁЯУв ржЖржорж╛ржжрзЗрж░ ржЪрзНржпрж╛ржирзЗрж▓</a>
    </footer>
  </main>

  <script>
    const API_URL = "https://your-backend-url.com"; // ЁЯФЧ ржЖржкржирж╛рж░ backend рж▓рж┐ржВржХ ржмрж╕рж╛ржи
    let token = null;

    // Theme Toggle
    document.getElementById("toggleTheme").onclick = () => {
      document.body.classList.toggle("dark");
      document.body.classList.toggle("light");
    };

    // Clock
    setInterval(() => {
      document.getElementById("clock").innerText = new Date().toLocaleTimeString();
    }, 1000);

    // Copy Number
    function copyNumber() {
      const num = document.getElementById("withdrawNumber").value;
      navigator.clipboard.writeText(num);
      alert("ржирж╛ржорзНржмрж╛рж░ ржХржкрж┐ рж╣рзЯрзЗржЫрзЗ тЬЕ");
    }

    // Dummy Login (Telegram WebApp)
    async function login() {
      const initData = window.Telegram?.WebApp?.initData || "";
      const res = await fetch(`${API_URL}/auth/login`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ initData })
      });
      const data = await res.json();
      if (data.ok) {
        token = data.token;
        document.getElementById("username").innerText = "Name: " + data.profile.firstName;
        document.getElementById("balance").innerText = "ржмрзНржпрж╛рж▓рж╛ржирзНрж╕: " + data.profile.balance.toFixed(2) + " ржЯрж╛ржХрж╛";
        document.getElementById("adsCount").innerText = "ржЖржЬржХрзЗрж░ ржмрж┐ржЬрзНржЮрж╛ржкржи: " + data.profile.dailyAds + "/100";
        document.getElementById("refCode").innerText = "рж░рзЗржлрж╛рж░ ржХрзЛржб: " + data.profile.referralCode;
        document.getElementById("refLink").value = "https://t.me/YourBot?start=" + data.profile.referralCode;
      }
    }

    // Watch Ad
    document.getElementById("watchAd").onclick = async () => {
      if (!token) return alert("ржЖржЧрзЗ рж▓ржЧржЗржи ржХрж░рзБржи");
      await new Promise(r => setTimeout(r, 10000)); // 10 рж╕рзЗржХрзЗржирзНржб
      const res = await fetch(`${API_URL}/ad/complete`, {
        method: "POST",
        headers: { "Content-Type": "application/json", "Authorization": "Bearer " + token }
      });
      const data = await res.json();
      if (data.ok) {
        document.getElementById("balance").innerText = "ржмрзНржпрж╛рж▓рж╛ржирзНрж╕: " + data.balance.toFixed(2) + " ржЯрж╛ржХрж╛";
        alert("ЁЯОЙ 0.20 ржЯрж╛ржХрж╛ ржпрзЛржЧ рж╣рзЯрзЗржЫрзЗ!");
      } else {
        alert(data.error);
      }
    };

    // Withdraw
    document.getElementById("withdrawBtn").onclick = async () => {
      if (!token) return alert("ржЖржЧрзЗ рж▓ржЧржЗржи ржХрж░рзБржи");
      const number = document.getElementById("withdrawNumber").value;
      const amount = parseFloat(document.getElementById("withdrawAmount").value);
      const res = await fetch(`${API_URL}/withdraw`, {
        method: "POST",
        headers: { "Content-Type": "application/json", "Authorization": "Bearer " + token },
        body: JSON.stringify({ number, amount })
      });
      const data = await res.json();
      alert(data.msg || data.error);
    };

    login();
  </script>
</body>
</html>